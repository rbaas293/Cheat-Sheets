# x86 registers, register conventions and calling conventions

## **x86 registers**

There are 9 registers in x86: EAX, EBX, ECX, EDX, ESI, EDI, EBP, ESP and EIP. These are mostly derived by prefixing E(Extended) to their 16 bit equivalents.

`EAX`: **The accumulator. This register typically stores return values from functions.**

`EBX`: **This register is typically the pointer to the base of an array.**

`ECX`: **This is typically used as a counter: loops, iterating through an array etc.**

`EDX`: **Commonly used as a supporting register. For example, 64 bit return values are returned in EDX:EAX in the code generated by 32 bit compilers.**

`ESI`: **The source index for string operations.**

`EDI`: **The destination index for string operations.**

`EBP`: **This register points to the base of the current function’s stack frame.**

`ESP`: **This register points to the top of the current function’s stack frame.**

`EIP`: **This register points to the address of the next instruction. This is the only instruction that cannot be manipulated by any instruction except call and ret.**

### **x86 register** **conventions**

`Caller` save registers: These registers have to be saved by the `caller` function if it wants to preserve their values. `EAX`, `ECX` and `EDX` are `caller` **save** registers. `EAX` is usually modified by the `callee` in almost all cases (it holds the return value remember?)

`Callee` save register: These registers have to be saved by `callee` function if it will modify these registers. `EBP`, `EBX`, `EDI` and `ESI` are callee save registers. `EBP` is usually modified by the `callee` in almost all cases(it points to the base of the function’s stack frame remember?)

#### **Calling conventions**

There are multiple ways to pass the parameters to the `callee` function. Here I will discuss 3 such conventions.

1. `CDECL` convention: **C Declaration**. In this convention, the parameters are passed in the reverse order(i.e. from right to left) on the stack by the `caller` and the `caller` is *responsible* for *cleaning up the parameters from the stack* i.e. it is **`caller` clean up**. *GCC* follows this convention. I think even MS Visual Studio does-at least the free Express edition.

2. `STDCALL` convention: **Standard Call**. This is *exactly same* as `CDECL` <u>except</u> that the `callee` is *responsible* for *removing the parameters from the stack* i.e. it is **`callee` clean up**. The *Win32 API* follows this convention.

3. `FASTCALL` convention: I have never encountered this convention before but the idea is that *some parameters are passed through the registers and rest through the stack*. There is no universal standard-each compiler designer has a different implementation of the convention. This is also **`callee` clean up**.

